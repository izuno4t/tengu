# アーキテクチャ概要

このプロジェクトは、複数のLLMプロバイダーとツール実行を統合するAIコーディングエージェントCLIです。CLI/TUI、エージェント実行ループ、ツール/権限、モデル抽象化、セッション管理を分離した構成を採用しています。

## モジュール構成

- `src/main.rs`: エントリーポイント。CLI起動と初期化を担う想定。
- `src/cli.rs`: 引数処理やコマンド分岐の中核。
- `src/agent/`: エージェント実行ループと意思決定の中心。
- `src/llm/`: LLMプロバイダー抽象化とAPI呼び出し。
- `src/tools/`: Read/Write/Shell等のツール実装と統合。
- `src/mcp/`: MCPサーバー統合とツール検出。
- `src/session/`: セッション管理と永続化。
- `src/config/`: 設定ファイル読み込みと既定値。
- `src/tui/`: インタラクティブUIの描画と入力処理。

## 制御フロー（概略）

1. `main.rs` がCLIを起動し、`cli.rs` が引数/モードを解釈する。
2. 設定・セッションをロードし、エージェント実行環境を構築する。
3. `agent` がLLMとツールを協調させて応答を生成する。
4. 対話モードは `tui`、非対話モードは `cli` が出力を制御する。

## 設定と拡張性

設定はTOMLを想定し、`config` が読み込みとデフォルト値を管理します。LLMプロバイダーは `llm` の抽象化で切り替え可能です。外部ツールは `tools` に実装し、必要に応じて `mcp` 経由で拡張します。

## 設計思想（認識共有）

- Tenguは**コーディングエージェント本体**として意思決定・計画・実行を担う。
- LLMは**推論/生成のバックエンド**であり、ツール実行や権限管理はTenguが担う。
- どのLLMを使っても**同一のエージェント挙動**を提供する。
- MCP/ツール/権限/監査ログは**Tenguの責務**として扱う。
- ベンダー固有のエージェント機能には依存せず、**Tenguの機能として統合**する。
